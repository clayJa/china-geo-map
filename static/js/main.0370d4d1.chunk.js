(this["webpackJsonpchina-geo-map"]=this["webpackJsonpchina-geo-map"]||[]).push([[0],{105:function(e,a,t){e.exports=t(221)},110:function(e,a,t){},217:function(e,a,t){},218:function(e,a,t){},219:function(e,a,t){},220:function(e,a,t){},221:function(e,a,t){"use strict";t.r(a);var n=t(1),i=t.n(n),r=t(103),o=t.n(r),c=(t(110),t(36)),s=t(44),u=t(16),l=t(17),p=t(19),h=t(18),m=t(12),d=t(20),v=t(35),f=t.n(v),y=t(4),b=t.n(y),g=(t(176),t(202),t(63)),j=t.n(g),k=t(104),O={site_title:"\u4e2d\u56fd\u5730\u56fe\u4e00\u89c8",site_toolbar:{zoom_out:"\u7f29\u5c0f",zoom_in:"\u653e\u5927",default:"\u9ed8\u8ba4\u5730\u56fe"},tag_name:"\u6807\u7b7e",search_url:"https://api.ownthink.com/kg/knowledge?entity=${query}"},w=["#92779B","#9FA9B2","#A0C5D2","#82B8B5","#52A1A7","#92779B","#9FA9B2","#A0C5D2","#83B8E0","#5898CF","#8E6E9C","#9CA6BD","#A0BAD9","#7BB1DD","#4B95CD","#978F91","#9FADB3","#9CC0E5","#86A8D9","#6982C5","#737FC3","#8BA6D8","#9CC0E5","#82B9C8","#499CA4"],E={"\u53f0\u6e7e":"taiwan","\u6cb3\u5317":"hebei","\u5c71\u897f":"shanxi","\u8fbd\u5b81":"liaoning","\u5409\u6797":"jilin","\u9ed1\u9f99\u6c5f":"heilongjiang","\u6c5f\u82cf":"jiangsu","\u6d59\u6c5f":"zhejiang","\u5b89\u5fbd":"anhui","\u798f\u5efa":"fujian","\u6c5f\u897f":"jiangxi","\u5c71\u4e1c":"shandong","\u6cb3\u5357":"henan","\u6e56\u5317":"hubei","\u6e56\u5357":"hunan","\u5e7f\u4e1c":"guangdong","\u6d77\u5357":"hainan","\u56db\u5ddd":"sichuan","\u8d35\u5dde":"guizhou","\u4e91\u5357":"yunnan","\u9655\u897f":"shanxi1","\u7518\u8083":"gansu","\u9752\u6d77":"qinghai","\u65b0\u7586":"xinjiang","\u5e7f\u897f":"guangxi","\u5185\u8499\u53e4":"neimenggu","\u5b81\u590f":"ningxia","\u897f\u85cf":"xizang","\u5317\u4eac":"beijing","\u5929\u6d25":"tianjin","\u4e0a\u6d77":"shanghai","\u91cd\u5e86":"chongqing","\u9999\u6e2f":"xianggang","\u6fb3\u95e8":"aomen"};function D(e,a){return A.apply(this,arguments)}function A(){return(A=Object(k.a)(j.a.mark((function e(a,t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(a,t);case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){var a,t,n,i,r,o,u=e.city?[e.city,"city"]:e.province?[e.province,"province"]:[e.country,"country"],l=Object(s.a)(u,2),p=l[0],h=l[1];return{deep_area:Object(c.a)({},p,{level:h}),area_values:[null===(a=e.country)||void 0===a?void 0:a.value,null===(t=e.province)||void 0===t?void 0:t.value,null===(n=e.city)||void 0===n?void 0:n.value].filter((function(e){return e})),area_names:[null===(i=e.country)||void 0===i?void 0:i.name,null===(r=e.province)||void 0===r?void 0:r.name,null===(o=e.city)||void 0===o?void 0:o.name].filter((function(e){return e}))}}function _(e){return(f()()(e.features)||[]).map((function(e,a){var t=(a+2+(a<<1))%w.length^5;return{name:e.properties.name,value:e.id,itemStyle:{color:w[t]||w[a%w.length]}}}))}t(217);var C=function(e){function a(e){var t;return Object(u.a)(this,a),(t=Object(p.a)(this,Object(h.a)(a).call(this,e))).chart=void 0,t.chart=null,t.renderMap=t.renderMap.bind(Object(m.a)(t)),t.resizeMap=t.resizeMap.bind(Object(m.a)(t)),t}return Object(d.a)(a,e),Object(l.a)(a,[{key:"componentDidMount",value:function(){this.chart=b.a.init(document.getElementById("map-content")),window.addEventListener("resize",this.resizeMap),this.chart.on("click",this.props.updateArea)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeMap)}},{key:"render",value:function(){return i.a.createElement("div",{id:"map-content"})}},{key:"componentDidUpdate",value:function(e){if((e.area!==this.props.area||e.data!==this.props.data)&&this.props.area&&this.props.data){var a=z(this.props.area).area_values.join("-");this.registerMap(a,this.props.data),this.renderMap(a,this.props.data)}}},{key:"registerMap",value:function(e,a){b.a.registerMap(e,a)}},{key:"renderMap",value:function(e,a){var t;null===(t=this.chart)||void 0===t||t.setOption({tooltip:{trigger:"item",formatter:"{b}"},toolbox:{show:!0,orient:"vertical",left:"right",top:"center",feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}},iconStyle:{normal:{color:"#fff"}}},animationDuration:1e3,animationEasing:"cubicOut",animationDurationUpdate:1e3,series:[{name:e,type:"map",roam:!1,map:e,data:_(a),label:{normal:{show:!0,textStyle:{color:"#666",fontSize:13}},emphasis:{show:!0,textStyle:{color:"#969696",fontSize:13}}}}]})}},{key:"resizeMap",value:function(){var e;null===(e=this.chart)||void 0===e||e.resize()}}]),a}(i.a.Component),M=(t(218),function(e){function a(){return Object(u.a)(this,a),Object(p.a)(this,Object(h.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(l.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"app-toolbar"},this.props.showZoomOut&&i.a.createElement("i",{className:"iconfont icon-suoxiao app-toolbar-item",title:O.site_toolbar.zoom_out,onClick:function(){return e.props.zoomMap("zoom_out")}}),this.props.showZoomOut&&i.a.createElement("i",{className:"iconfont icon-ditu app-toolbar-item",title:O.site_toolbar.default,onClick:function(){return e.props.zoomMap("zoom_default")}}))}}]),a}(i.a.Component)),N=(t(219),function(e){function a(){return Object(u.a)(this,a),Object(p.a)(this,Object(h.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(l.a)(a,[{key:"render",value:function(){var e,a,t,n,r=z(this.props.area).area_values.join("-"),o=(null===(e=this.props.data)||void 0===e?void 0:e.avp)&&function(e){var a={};return e.forEach((function(e){var t=e[0];a[t]=a[t]||[],a[t].push(e[1])})),a}(this.props.data.avp);return i.a.createElement("div",{className:"app-wiki"},i.a.createElement("div",{className:"app-wiki-title"},null===(a=this.props.data)||void 0===a?void 0:a.entity),i.a.createElement("div",{className:"app-wiki-desc"},null===(t=this.props.data)||void 0===t?void 0:t.desc),i.a.createElement("div",{className:"app-wiki-items"},o&&Object.keys(o).map((function(e){return i.a.createElement("div",{className:"app-wiki-item",key:r+":"+e},i.a.createElement("span",{className:"app-wiki-item-name"},e,"\uff1a"),i.a.createElement("span",{className:"app-wiki-item-value"},o[e].join("\u3001")))}))),(null===(n=this.props.data)||void 0===n?void 0:n.tag)&&this.props.data.tag.length>0&&i.a.createElement("div",{className:"app-wik-tags"},i.a.createElement("span",{className:"app-wiki-tags-name"},O.tag_name,"\uff1a"),i.a.createElement("span",{className:"app-wik-tags-value"},this.props.data.tag.join("\u3001"))))}}]),a}(i.a.Component)),B=(t(220),function(e){function a(e){var t;return Object(u.a)(this,a),(t=Object(p.a)(this,Object(h.a)(a).call(this,e))).defaultArea={country:{name:"\u4e2d\u56fd",value:"china"}},t.state={area:t.defaultArea},t.fetchAreaData=t.fetchAreaData.bind(Object(m.a)(t)),t.updateArea=t.updateArea.bind(Object(m.a)(t)),t.zoomMap=t.zoomMap.bind(Object(m.a)(t)),t}return Object(d.a)(a,e),Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchAreaData(this.state.area)}},{key:"render",value:function(){return function(e){var a=e.area,t=e.title,n=void 0===t?O.site_title:t;if(!a)return document.title=n;var i=z(a),r=f()()(i.area_names);r.shift(),r.push(n),document.title=r.join(" - ")}({area:this.state.area}),i.a.createElement("div",{className:"app"},i.a.createElement("div",{className:"app-header"},i.a.createElement("div",{className:"app-header-title"},O.site_title)),i.a.createElement("div",{className:"app-main"},this.state.wikiData&&i.a.createElement("div",{className:"app-main-wiki-container"},i.a.createElement(N,{data:this.state.wikiData,area:this.state.area})),i.a.createElement("div",{className:"app-main-map-container"},i.a.createElement(C,{area:this.state.area,data:this.state.geoData,updateArea:this.updateArea}))),i.a.createElement("div",{className:"app-footer"},i.a.createElement(M,{showZoomOut:!!this.state.area.city||!!this.state.area.province,zoomMap:this.zoomMap})))}},{key:"fetchGeoData",value:function(e){var a=this;D(function(e){var a=null,t=z(e);switch(t.deep_area.level){case"province":a="provinces/".concat(E[t.deep_area.name]);break;case"city":a="cities/".concat(t.deep_area.value);break;default:a="".concat(t.deep_area.value||"china")}return"".concat(window.location,"/data/map/").concat(a,".json")}(e)).then((function(t){a.setState({geoData:t,area:e})})).catch((function(e){console.error(e)}))}},{key:"updateArea",value:function(e){var a,t,n,i=this.state.area,r={};if(e.data){var o=(e.seriesName||"").split("-"),u=Object(s.a)(o,3),l=u[0],p=u[1],h=u[2],m={name:e.data.name,value:e.data.value};if(l&&l===(null===(a=i.country)||void 0===a?void 0:a.value))if(p&&p===(null===(t=i.province)||void 0===t?void 0:t.value))if(h&&h===(null===(n=i.city)||void 0===n?void 0:n.value)){if(m.name)return this.fetchWikiData(Object(c.a)({},this.state.area,{county:m}));r=Object(c.a)({},this.defaultArea)}else r={country:i.country,province:i.province,city:m};else r={country:i.country,province:m};else r.country=m;this.fetchAreaData(r)}}},{key:"zoomMap",value:function(e){switch(e){case"zoom_out":var a=f()()(this.state.area);a.city?delete a.city:a.province&&delete a.province,this.fetchAreaData(a);break;case"zoom_default":this.fetchAreaData(this.defaultArea)}}},{key:"fetchWikiData",value:function(e){var a,t=this,n=e.county?e.county.name:e.city?e.city.name:e.province?e.province.name:null===(a=e.country)||void 0===a?void 0:a.name;n&&(e.county||e.city||!e.province||(n=n.replace(/\u5e02$/,"")),D(O.search_url.replace("${query}",encodeURIComponent(n))).then((function(e){"success"===e.message?t.setState({wikiData:e.data}):t.setState({wikiData:null})})))}},{key:"fetchAreaData",value:function(e){this.fetchGeoData(e),this.fetchWikiData(e)}}]),a}(i.a.Component));o.a.render(i.a.createElement(B,null),document.getElementById("root"))}},[[105,1,2]]]);
//# sourceMappingURL=main.0370d4d1.chunk.js.map